{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/core/constants/default.js","webpack:///./src/core/constants/event.js","webpack:///./src/core/constants/status.js","webpack:///./src/core/constants/checker.js","webpack:///./node_modules/@lppjunior/pattern-js/src/pattern/observer/Observer.js","webpack:///./node_modules/@lppjunior/pattern-js/src/pattern/observer/index.js","webpack:///./node_modules/@lppjunior/pattern-js/src/pattern/pipeline/Pipeline.js","webpack:///./src/core/Actions.js","webpack:///./src/core/Board.js","webpack:///./src/core/State.js","webpack:///./src/core/Minefield.js","webpack:///./src/main.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","GLOBALS","debug","makeLevel","amount","cols","rows","mines","DEFAULTS","EASY","MEDIUM","HARD","EVENT","START","NEXT_TURN","FINISH","STATUS","LOSS","PLAYING","WIN","CHECKER","EMPTY","FLAG","MINE","NUMBER_0","NUMBER_1","NUMBER_2","NUMBER_3","NUMBER_4","NUMBER_5","NUMBER_6","NUMBER_7","NUMBER_8","this","observer","event","callback","addEvent","push","data","forEach","undefined","updateValue","row","col","state","setValue","indexOf","set","openAll","board","map","_","__","open","isFinish","getValue","expand","nextTurn","flag","lastValue","parentRow","parentCol","options","makeBoard","makeMines","Array","fill","count","mine","getRandomMap","_mine","join","fillAround","rand","size","Math","floor","random","make","init","total","status","checked","updated","isWin","isLoss","fn","on","emit","getState","updateStatus","length","keys","Actions","action","getInstance","game","instance","addListener","start","x","y","reset"],"mappings":"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","file":"minefield.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const GLOBALS = {\r\n  debug: false\r\n}\r\n\r\nconst makeLevel = amount => ({\r\n  cols: amount,\r\n  rows: amount,\r\n  mines: amount\r\n})\r\n\r\nexport const DEFAULTS = {\r\n  EASY: {\r\n    ...GLOBALS,\r\n    ...makeLevel(10)\r\n  },\r\n\r\n  MEDIUM: {\r\n    ...GLOBALS,\r\n    ...makeLevel(15)\r\n  },\r\n\r\n  HARD: {\r\n    ...GLOBALS,\r\n    ...makeLevel(30)\r\n  }\r\n}\r\n","export const EVENT = {\r\n  START: 'start',\r\n  NEXT_TURN: 'nextTurn',\r\n  FINISH: 'finish'\r\n}\r\n","export const STATUS = {\r\n  LOSS: 'LOSS',\r\n  PLAYING: 'PLAYING',\r\n  WIN: 'WIN'\r\n}\r\n","export const CHECKER = {\r\n  EMPTY: '',\r\n  FLAG: 'F',\r\n  MINE: -1,\r\n  NUMBER_0: 0,\r\n  NUMBER_1: 2,\r\n  NUMBER_2: 3,\r\n  NUMBER_3: 3,\r\n  NUMBER_4: 4,\r\n  NUMBER_5: 5,\r\n  NUMBER_6: 6,\r\n  NUMBER_7: 7,\r\n  NUMBER_8: 8\r\n}\r\n","class Observer {\n  constructor () {\n    this.observer = []\n  }\n\n  on (event, callback) {\n    this.addEvent(event)\n    this.observer[event].push(callback)\n\n    return this\n  }\n\n  emit (event, data) {\n    this.addEvent(event)\n    this.observer[event].forEach(callback => callback(data))\n  }\n\n  addEvent (event) {\n    if (this.observer[event] === undefined) {\n      this.observer[event] = []\n    }\n  }\n}\n\nexport default Observer\n","import Observer from './Observer'\n\nexport default Observer\n","class Pipeline {\n  constructor () {\n    this.pipelines = []\n  }\n\n  pipe (callback) {\n    this.pipelines.push(callback)\n    return this\n  }\n\n  process (data) {\n    let result = data\n    return this.pipelines.map(fn => (result = fn(result))).pop()\n  }\n}\n\nexport default Pipeline\n","import { CHECKER } from './constants'\n\nexport default {\n  updateValue: function (row, col, value) {\n    this.state.setValue(row, col, value)\n    this.state.get('updated').push({ row, col, value })\n\n    if ([CHECKER.EMPTY, CHECKER.FLAG, CHECKER.MINE].indexOf(value) === -1) {\n      this.state.set('checked', this.state.get('checked') + 1)\n    }\n  },\n\n  openAll: function () {\n    const board = this.state.get('board')\n    board.map((_, row) => _.map((__, col) => {\n      board[row][col] = this.board[row][col]\n    }))\n\n    this.state.set('board', board)\n  },\n\n  open: function (row, col) {\n    if (this.state.isFinish()) {\n      return\n    }\n\n    this.state.set('updated', [])\n\n    if (this.state.getValue(row, col) === CHECKER.EMPTY) {\n      const value = this.board[row][col]\n\n      this.updateValue(row, col, value)\n\n      if (value === 0) {\n        this.expand(row, col)\n      }\n    }\n\n    this.nextTurn()\n  },\n\n  flag: function (row, col) {\n    if (this.state.isFinish()) {\n      return\n    }\n\n    this.state.set('updated', [])\n\n    const lastValue = this.state.getValue(row, col)\n    if ([CHECKER.FLAG, CHECKER.EMPTY].indexOf(lastValue) > -1) {\n      this.updateValue(row, col, lastValue === CHECKER.FLAG ? CHECKER.EMPTY : CHECKER.FLAG)\n    }\n\n    this.nextTurn()\n  },\n\n  expand: function (parentRow, parentCol) {\n    for (let row = parentRow - 1; row <= parentRow + 1; row++) {\n      for (let col = parentCol - 1; col <= parentCol + 1; col++) {\n        if (this.board[row] !== undefined &&\n            this.board[row][col] !== undefined &&\n            this.board[row][col] >= CHECKER.NUMBER_0 &&\n            this.board[row][col] <= CHECKER.NUMBER_8 &&\n            this.state.get('board')[row][col] === CHECKER.EMPTY) {\n          this.updateValue(row, col, this.board[row][col])\n\n          if (this.board[row][col] === CHECKER.NUMBER_0) {\n            this.expand(row, col)\n          }\n        }\n      }\n    }\n  }\n}\n","import { CHECKER } from './constants'\r\n\r\nclass Board {\r\n  constructor (options) {\r\n    this.options = options\r\n  }\r\n\r\n  make () {\r\n    this.makeBoard()\r\n    this.makeMines()\r\n\r\n    return this.data\r\n  }\r\n\r\n  makeBoard () {\r\n    this.data = Array(this.options.rows)\r\n      .fill(null)\r\n      .map(() => Array(this.options.cols)\r\n        .fill(null)\r\n        .map(() => 0)\r\n      )\r\n  }\r\n\r\n  makeMines () {\r\n    let count = 0\r\n    let mines = ''\r\n\r\n    do {\r\n      const mine = this.getRandomMap()\r\n      const _mine = `${mine.join(',')}|`\r\n\r\n      if (mines.indexOf(_mine) === -1) {\r\n        this.data[mine[0]][mine[1]] = CHECKER.MINE\r\n        this.fillAround(mine)\r\n\r\n        mines += _mine\r\n        count++\r\n      }\r\n    } while (count < this.options.mines)\r\n  }\r\n\r\n  fillAround (mine) {\r\n    for (let row = mine[0] - 1; row <= mine[0] + 1; row++) {\r\n      for (let col = mine[1] - 1; col <= mine[1] + 1; col++) {\r\n        if (this.data[row] !== undefined && this.data[row][col] !== undefined && this.data[row][col] > -1) {\r\n          this.data[row][col]++\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getRandomMap () {\r\n    const rand = (size) => Math.floor(Math.random() * size)\r\n\r\n    return [\r\n      rand(this.options.rows),\r\n      rand(this.options.cols)\r\n    ]\r\n  }\r\n}\r\n\r\nBoard.make = (options) => ((new Board(options)).make())\r\n\r\nexport default Board\r\n","import { STATUS } from './constants'\r\n\r\nclass State {\r\n  constructor (options, board) {\r\n    this.options = options\r\n    this.board = board\r\n\r\n    this.init()\r\n  }\r\n\r\n  init () {\r\n    this.state = {\r\n      rows: this.options.rows,\r\n      cols: this.options.cols,\r\n      total: this.options.cols * this.options.rows - this.options.mines,\r\n      status: STATUS.PLAYING,\r\n      checked: 0,\r\n      updated: [],\r\n      board: Array(this.options.rows)\r\n        .fill(null)\r\n        .map(() => Array(this.options.cols)\r\n          .fill(null)\r\n          .map(() => '')\r\n        )\r\n    }\r\n  }\r\n\r\n  get (key) {\r\n    return key ? this.state[key] : this.state\r\n  }\r\n\r\n  set (key, value) {\r\n    this.state[key] = value\r\n  }\r\n\r\n  getValue (row, col) {\r\n    return this.state.board[row][col]\r\n  }\r\n\r\n  setValue (row, col, value) {\r\n    this.state.board[row][col] = value\r\n  }\r\n\r\n  isWin () {\r\n    return this.get('status') === STATUS.WIN\r\n  }\r\n\r\n  isLoss () {\r\n    return this.get('status') === STATUS.LOSS\r\n  }\r\n\r\n  isFinish () {\r\n    return this.isWin() || this.isLoss()\r\n  }\r\n}\r\n\r\nexport default State\r\n","import { Observer } from '@lppjunior/pattern-js'\r\n\r\nimport Actions from './Actions'\r\nimport Board from './Board'\r\nimport State from './State'\r\nimport { EVENT, STATUS, CHECKER } from './constants'\r\n\r\nclass Minefield {\r\n  constructor (options) {\r\n    this.options = {\r\n      ...options\r\n    }\r\n\r\n    this.observer = new Observer()\r\n  }\r\n\r\n  addListener (event, fn) {\r\n    this.observer.on(event, fn)\r\n  }\r\n\r\n  emit (event) {\r\n    this.observer.emit(event, this.getState())\r\n  }\r\n\r\n  start () {\r\n    this.board = Board.make(this.options)\r\n    this.state = new State(this.options, this.board)\r\n\r\n    this.emit(EVENT.START)\r\n\r\n    return this\r\n  }\r\n\r\n  getState () {\r\n    const data = this.state.get()\r\n\r\n    if (this.options.debug) {\r\n      data.debug = {\r\n        board: this.board\r\n      }\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  nextTurn () {\r\n    this.updateStatus()\r\n\r\n    switch (this.state.get('status')) {\r\n      case STATUS.PLAYING:\r\n        this.emit(EVENT.NEXT_TURN)\r\n        break\r\n      case STATUS.LOSS:\r\n      case STATUS.WIN:\r\n        this.openAll()\r\n        this.emit(EVENT.FINISH)\r\n        break\r\n    }\r\n  }\r\n\r\n  updateStatus () {\r\n    if (this.state.get('updated').length === 0) return\r\n\r\n    this.state.set('status',\r\n      this.state.get('updated')[0].value === CHECKER.MINE ? STATUS.LOSS\r\n        : this.state.get('checked') === this.state.get('total') ? STATUS.WIN\r\n          : STATUS.PLAYING\r\n    )\r\n  }\r\n}\r\n\r\nObject.keys(Actions).forEach(action => { Minefield.prototype[action] = Actions[action] })\r\n\r\nexport default Minefield\r\n","import * as CONFIG from './core/constants'\r\nimport { Minefield } from './core'\r\n\r\nexport function getInstance (options = CONFIG.DEFAULTS.MEDIUM) {\r\n  const game = new Minefield(options)\r\n\r\n  const instance = {\r\n    addListener: (event, fn) => {\r\n      game.addListener(event, fn)\r\n\r\n      return instance\r\n    },\r\n    start: () => game.start(),\r\n    open: (x, y) => game.open(x, y),\r\n    flag: (x, y) => game.flag(x, y),\r\n    getState: () => game.getState(),\r\n    reset: () => game.start(),\r\n\r\n    STATUS: CONFIG.STATUS,\r\n    ...CONFIG.EVENT\r\n  }\r\n\r\n  return instance\r\n}\r\n\r\nexport const DEFAULTS = CONFIG.DEFAULTS\r\nexport const CHECKER = CONFIG.CHECKER\r\nexport const STATUS = CONFIG.STATUS\r\n\r\nexport default {\r\n  getInstance\r\n}\r\n"],"sourceRoot":""}